(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["EditInscription"],{2351:function(t,e,n){t.exports=n.p+"static/img/icon-2.124ffdfa.png"},"24af":function(t,e,n){t.exports=n.p+"static/img/icon-3.b0f453c4.png"},"28a5":function(t,e,n){"use strict";var s=n("aae3"),i=n("cb7c"),a=n("ebd6"),r=n("0390"),o=n("9def"),c=n("5f1b"),l=n("520a"),u=n("79e5"),m=Math.min,p=[].push,f="split",d="length",v="lastIndex",h=4294967295,b=!u((function(){RegExp(h,"y")}));n("214f")("split",2,(function(t,e,n,u){var g;return g="c"=="abbc"[f](/(b)*/)[1]||4!="test"[f](/(?:)/,-1)[d]||2!="ab"[f](/(?:ab)*/)[d]||4!="."[f](/(.?)(.?)/)[d]||"."[f](/()()/)[d]>1||""[f](/.?/)[d]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!s(t))return n.call(i,t,e);var a,r,o,c=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),m=0,f=void 0===e?h:e>>>0,b=new RegExp(t.source,u+"g");while(a=l.call(b,i)){if(r=b[v],r>m&&(c.push(i.slice(m,a.index)),a[d]>1&&a.index<i[d]&&p.apply(c,a.slice(1)),o=a[0][d],m=r,c[d]>=f))break;b[v]===a.index&&b[v]++}return m===i[d]?!o&&b.test("")||c.push(""):c.push(i.slice(m)),c[d]>f?c.slice(0,f):c}:"0"[f](void 0,0)[d]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,s){var i=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,i,s):g.call(String(i),n,s)},function(t,e){var s=u(g,t,this,e,g!==n);if(s.done)return s.value;var l=i(t),p=String(this),f=a(l,RegExp),d=l.unicode,v=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(b?"y":"g"),_=new f(b?l:"^(?:"+l.source+")",v),C=void 0===e?h:e>>>0;if(0===C)return[];if(0===p.length)return null===c(_,p)?[p]:[];var x=0,y=0,z=[];while(y<p.length){_.lastIndex=b?y:0;var k,w=c(_,b?p:p.slice(y));if(null===w||(k=m(o(_.lastIndex+(b?0:y)),p.length))===x)y=r(p,y,d);else{if(z.push(p.slice(x,y)),z.length===C)return z;for(var I=1;I<=w.length-1;I++)if(z.push(w[I]),z.length===C)return z;y=x=k}}return z.push(p.slice(x)),z}]}))},"408b":function(t,e,n){"use strict";var s=n("bc3a"),i=n.n(s),a=i.a.create({baseURL:"/nin/mosai/",timeout:4e4,withCredentials:!0});a.interceptors.request.use((function(t){return t.headers["Accept"]="application/vnd.sd.v2+json",t}),(function(t){Promise.reject(t)})),a.interceptors.response.use((function(t){return console.log(t,"response"),1!==t.data.err_code?Promise.reject(t.data):t}));var r=a;function o(t){return r({url:"pbiwm.do",method:"post",data:t})}function c(t){return r({url:"pbiwmm.do",method:"post",data:t})}function l(t){return r({url:"pbihd.do",method:"post",data:t})}function u(t){return r({url:"pbihdm.do",method:"post",data:t})}n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return u}))},"46b7":function(t,e,n){t.exports=n.p+"static/img/return.c1430e4a.png"},"7f58":function(t,e,n){"use strict";var s=n("d2e5"),i=n.n(s);i.a},"82e0":function(t,e,n){t.exports=n.p+"static/img/Loading_20210708.31344e8f.gif"},"8d72":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"edit-blazon"},[s("div",{staticClass:"edition-center"},[s("div",{staticClass:"left",staticStyle:{position:"relative"}},[2===t.status?s("el-image",{staticClass:"minted-image",staticStyle:{width:"431px",position:"relative"},attrs:{src:t.mintedImage}}):t._e(),t._v(" "),0===t.status||1===t.status?s("el-image",{ref:"master",staticStyle:{width:"431px",position:"relative"},attrs:{src:t.masterSrc}}):t._e(),t._v(" "),0===t.status||1===t.status?s("div",{directives:[{name:"drag",rawName:"v-drag",value:0===t.status,expression:"status===0"}],ref:"blazon",staticClass:"blazon-box",staticStyle:{top:"230px",left:"0"},style:{left:t.blazonX+"px",top:t.blazonY+"px",transform:"scale("+t.blazonZoom+") rotateZ("+t.blazonDeg+"deg)"},on:{mousemove:t.bMousemove}},[s("span",{staticClass:"decorate-left"},[t._v("@theworId")]),t._v(" "),s("span",{staticClass:"text",domProps:{innerHTML:t._s(t.introduceText)}}),t._v(" "),s("span",{staticClass:"decorate-right"},[t._v("@elonmusk")])]):t._e(),t._v(" "),0===t.status?s("div",{staticClass:"options"},[s("i",{staticClass:"el-icon-circle-plus",on:{click:function(e){return t.optionClick("plus")}}}),t._v(" "),s("i",{staticClass:"el-icon-remove",on:{click:function(e){return t.optionClick("remove")}}}),t._v(" "),s("i",{staticClass:"el-icon-caret-left",on:{click:function(e){return t.optionClick("left")}}}),t._v(" "),s("i",{staticClass:"el-icon-caret-right",on:{click:function(e){return t.optionClick("right")}}}),t._v(" "),s("i",{staticClass:"el-icon-caret-bottom",on:{click:function(e){return t.optionClick("bottom")}}}),t._v(" "),s("i",{staticClass:"el-icon-caret-top",on:{click:function(e){return t.optionClick("top")}}}),t._v(" "),s("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return t.optionClick("refresh-right")}}}),t._v(" "),s("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return t.optionClick("refresh-left")}}})]):t._e(),t._v(" "),2===t.status?s("div",{staticClass:"dow",style:{top:t.画板高度+230+"px"}},[s("p",{staticClass:"title-tip"},[t._v("Minted!")]),t._v(" "),t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3)]):t._e()],1),t._v(" "),s("div",{staticClass:"right"},[0===t.status?s("div",{staticClass:"right-mint-box"},[s("p",{staticClass:"return-icon",on:{click:function(e){return t.$route.go(-1)}}},[s("img",{attrs:{src:n("46b7"),alt:""}})]),t._v(" "),s("div",{staticClass:"set-message"},[s("p",{staticClass:"title"},[t._v("Edit Inscription")]),t._v(" "),s("p",{staticClass:"label"},[t._v("Master")]),t._v(" "),s("p",{staticClass:"introduce"},[t._v("The NFT Song")]),t._v(" "),s("p",{staticClass:"label"},[t._v("Inscription")]),t._v(" "),s("div",[s("el-input",{model:{value:t.introduceText,callback:function(e){t.introduceText=e},expression:"introduceText"}})],1),t._v(" "),s("div",{ref:"blazon-img",staticClass:"blazon-box"},[s("span",{staticClass:"decorate-left"},[t._v("@theworId")]),t._v(" "),s("span",{staticClass:"text",domProps:{innerHTML:t._s(t.introduceText)}}),t._v(" "),s("span",{staticClass:"decorate-right"},[t._v("@elonmusk")])]),t._v(" "),s("p",{staticClass:"label"},[t._v("Style")]),t._v(" "),t._m(4),t._v(" "),s("p",{staticClass:"label"},[t._v("Font Size")]),t._v(" "),s("div",{staticClass:"coordinate-mess"},[s("div",{staticClass:"itme"},[s("el-input",{attrs:{value:t.blazonX,size:"small"},on:{input:t.xChange}})],1)]),t._v(" "),s("p",{staticClass:"label"},[t._v("Coordinate")]),t._v(" "),s("div",{staticClass:"coordinate-mess"},[s("div",{staticClass:"itme"},[s("span",{staticStyle:{"margin-right":"10px"}},[t._v("X")]),t._v(" "),s("el-input",{attrs:{value:t.blazonX,size:"small"},on:{input:t.xChange}})],1),t._v(" "),s("div",{staticClass:"itme"},[s("span",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[t._v("Y")]),t._v(" "),s("el-input",{attrs:{value:t.blazonY,size:"small"},on:{input:t.yChange}})],1)]),t._v(" "),s("p",{staticClass:"label"},[t._v("Size")]),t._v(" "),s("div",{staticClass:"coordinate-mess size-itme"},[s("div",{staticClass:"itme"},[s("el-input",{attrs:{size:"small"},model:{value:t.blazonZoom,callback:function(e){t.blazonZoom=e},expression:"blazonZoom"}}),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("%")])],1)]),t._v(" "),s("p",{staticClass:"label",staticStyle:{"margin-top":"20px"}},[t._v("Rotate")]),t._v(" "),s("div",{staticClass:"coordinate-mess size-itme"},[s("div",{staticClass:"itme"},[s("el-input",{attrs:{size:"small"},model:{value:t.blazonDeg,callback:function(e){t.blazonDeg=e},expression:"blazonDeg"}}),s("span",{staticStyle:{"margin-left":"10px"}},[t._v("°")])],1)]),t._v(" "),t._m(5),t._v(" "),s("p",{staticClass:"label",staticStyle:{"margin-top":"55px","margin-bottom":"17px","font-weight":"bold"}},[t._v("\n            Estimated Gas\n          ")]),t._v(" "),s("p",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[t._v("\n            0.0245 ETH (about $54.53)\n          ")]),t._v(" "),s("p",{staticClass:"btn",on:{click:t.submit}},[t._v("Print")])])]):t._e(),t._v(" "),1===t.status?[s("el-image",{staticStyle:{"margin-top":"300px"},attrs:{src:n("82e0")}})]:t._e(),t._v(" "),1===t.status?s("div",{staticClass:"minted-btn",on:{click:t.mint}},[t._v("\n        Inscription\n      ")]):t._e(),t._v(" "),2===t.status?s("div",{staticClass:"minted-btn"},[t._v("\n        Imprint another one\n      ")]):t._e()],2)]),t._v(" "),s("div",{ref:"blazon-img",staticClass:"blazon-box",staticStyle:{position:"relative",left:"0",top:"0",display:"inline-block"},style:{},on:{mousemove:t.bMousemove}},[s("span",{staticClass:"decorate-left"},[t._v("@theworId")]),t._v(" "),s("span",{staticClass:"text",domProps:{innerHTML:t._s(t.introduceText)}}),t._v(" "),s("span",{staticClass:"decorate-right"},[t._v("@elonmusk")])])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"item-info"},[n("label",[t._v("Time")]),t._v("2021.04.19,08:15pm EST")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"item-info"},[n("label",[t._v("Collection")]),t._v("Imprint Rarible"),n("span",[t._v("(0x79544b2341067e9bb314a67f6d7495908b047e)")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"item-info"},[n("label",[t._v("Token ID")]),t._v("23456")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"item-info"},[n("label",[t._v("# of Imprints")]),t._v("1")])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"introduce-items"},[n("div",{staticClass:"item"},[t._v("\n              123\n            ")]),t._v(" "),n("div",{staticClass:"item"},[t._v("\n              123\n            ")]),t._v(" "),n("div",{staticClass:"item"},[t._v("\n              123\n            ")]),t._v(" "),n("div",{staticClass:"item"},[t._v("\n              123\n            ")]),t._v(" "),n("div",{staticClass:"item"},[t._v("\n              123\n            ")]),t._v(" "),n("div",{staticClass:"item"},[t._v("\n              123\n            ")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"icon-box"},[s("img",{attrs:{src:n("24af"),alt:""}}),t._v(" "),s("img",{attrs:{src:n("2351"),alt:""}})])}],a=(n("8e6e"),n("ac6a"),n("456d"),n("28a5"),n("96cf"),n("3b8d")),r=(n("c5f6"),n("bd86")),o=(n("6107"),n("70b0")),c=n.n(o),l=n("408b"),u=n("2f62"),m=n("d06f"),p=n("5991");function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){Object(r["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:"EditButton",data:function(){return{introduceText:"",blazonZoom:1,blazonDeg:0,blazonX:0,blazonY:230,masterSrc:"",blazonSrc:"",masterIndex:0,blazonIndex:0,cropperDom:null,masterWidth:431,"画板高度":0,status:0,mintedImage:"",blazonImgWidth:120,resultNewtokenUrl:null}},computed:d({},Object(u["c"])({contractAddress:function(t){return t.contract["contractAddress"]},mosaique:function(t){return t.contract["CollectionContract"].mosaique},userAddress:function(t){return t.walletAccount["userAddress"]},formatEth:function(t){return t.walletAccount.formatEth},imageItems:function(t){return t.nft.userNfts}})),created:function(){var t=this.$route.query.master;t=Number(t);var e=new Image,n=this;e.src=this.imageItems[t].image,e.onload=function(){n.masterSrc=n.imageItems[t].image,n.masterWidth=this.width}},mounted:function(){this.cropperDom=this.$refs.cropper},methods:{xChange:function(t){var e=this.$refs["blazon"];e.style.left=parseInt(t||0)+"px",this.blazonX=parseInt(e.style.left)},yChange:function(t){var e=this.$refs["blazon"];e.style.top=parseInt(t||0)+"px",this.blazonY=parseInt(e.style.top)},bMousemove:function(){var t=this.$refs["blazon"];this.blazonX=parseInt(t.style.left),this.blazonY=parseInt(t.style.top)},compose_image:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,s,i,a,r,o,u,m,p,f,d,v,h,b,g,_,C,x,y,z=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.$refs["blazon"].getBoundingClientRect(),n=this.$refs["master"].$el.getBoundingClientRect(),s=e.left,i=e.top,a=e.width,r=e.height,o=n.left,u=n.top,m=n.width,p=n.height,f=s<o?s:o,d=i<u?i:u,v=(s+a>o+m?s+a:o+m)-f,h=(i+r>u+p?i+r:u+p)-d,this.画板高度=h,b=m/this.masterWidth,g=this.blazonZoom,this.status=1,_=2,this.blazonImgWidth=a,console.log(this.$refs["blazon-img"].clientWidth),t.next=23,c.a.toPng(this.$refs["blazon-img"],{width:this.$refs["blazon-img"].getBoundingClientRect().width*_,height:this.$refs["blazon-img"].getBoundingClientRect().height*_,style:{transform:"scale("+_+")",transformOrigin:"top left"}}).then((function(t){return t}));case 23:return C=t.sent,x=this.$route.query.master,x=Number(x),t.next=28,l["a"]({drawing_board_width:Number(v/b).toFixed(0)+"",drawing_board_height:Number(h/b).toFixed(0)+"",master_contract:this.imageItems[x].contractAddress,master_tokenid:this.imageItems[x].tokenOfOwnerByIndex,master_x:Number((o-f)/b).toFixed(0)+"",master_y:Number((u-d)/b).toFixed(0)+"",image_txt:C.split(",")[1],image_txt_x:Number((s-f)/b).toFixed(0)+"",image_txt_y:Number((i-d)/b).toFixed(0)+"",image_txt_rotate:Number(this.blazonDeg).toFixed(0)+"",image_txt_scale:Number(g/b/_).toFixed(2)+"",jsoninfo:"7b0a20202020227469746c65223a202262756c6c222c0a2020202022696d6167655f75726c223a202268747470733a2f2f696d67312e6d706179732e696f2f6d7061792f696d672f616e696d616c2f636174746c652f62756c6c2e706e67220a7d"}).then((function(t){return z.mintedImage=t.data.compose_image,t})).catch((function(t){z.status=0,z.$message.error(t.message||t.msg)}));case 28:return y=t.sent,t.abrupt("return",y);case 30:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),erc721transfer:function(){var t=this,e=this.$route.query.master,n=p["a"](this.contractAddress,this.userAddress,this.userAddress,this.mosaique,this.imageItems[e].tokenOfOwnerByIndex).on("transactionHash",(function(e){console.log(e,"reject"),t.loadingTransferHash(e,1)}));return n},loadingTransferHash:function(t,e){var n=this;return console.log("loadingTransferHash"),m["a"].getTransactionReceipt(t).then((function(s){if(console.log(s,"res"),null!==s&&0!==s)return n.status=e,!0;setTimeout((function(){return n.loadingTransferHash(t,e)}),1e3)})).catch((function(t){return console.log(t),!1}))},submit:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.compose_image();case 2:this.resultNewtokenUrl=t.sent,this.erc721transfer();case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),sign:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(e){var n,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.master_nft_mid,s=e.token_uri,i=null,!n){t.next=6;break}return t.next=5,p["d"]([n,s],["bytes32","string"]);case 5:i=t.sent;case 6:return console.log(i,"signature"),t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),mint:function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(){var e,n,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("mint"),this.status=-1,e=this.resultNewtokenUrl.data,t.next=5,this.sign(e);case 5:if(n=t.sent,!n){t.next=9;break}return t.next=9,l["c"]({master_nft_mid:e.master_nft_mid,new_token_uri:e.token_uri,owner:this.userAddress,signature:n}).then((function(t){s.status=2,console.log(t)})).catch((function(t){s.loadingTransferHash(t.transaction_hash,2)}));case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),optionClick:function(t){var e=this.$refs["blazon"];switch(console.log(e),t){case"plus":this.blazonZoom+=.1;break;case"remove":this.blazonZoom-=.1;break;case"left":e.style.left=parseInt(e.style.left||0)-10+"px",this.blazonX=parseInt(e.style.left);break;case"right":e.style.left=parseInt(e.style.left||0)+10+"px",this.blazonX=parseInt(e.style.left);break;case"bottom":e.style.top=parseInt(e.style.top||0)+10+"px",this.blazonY=parseInt(e.style.top);break;case"top":e.style.top=parseInt(e.style.top||0)-10+"px",this.blazonY=parseInt(e.style.top);break;case"refresh-right":this.blazonDeg+=45;break;case"refresh-left":this.blazonDeg-=45;break}},ready:function(){this.cropperDom.relativeZoom(-2),this.optionClick()},cropmove:function(){this.optionClick()},zoom:function(){this.optionClick()}}},h=v,b=(n("7f58"),n("2877")),g=Object(b["a"])(h,s,i,!1,null,null,null);e["default"]=g.exports},aae3:function(t,e,n){var s=n("d3f4"),i=n("2d95"),a=n("2b4c")("match");t.exports=function(t){var e;return s(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},d2e5:function(t,e,n){}}]);